---
title: "Working with Page Events"
description: "In this topic, you will learn how to listen and work with page events when using a custom plugin for your Brightcove Beacon web apps."
parent: "OTT Plugins"
layout: "staging"
---
<h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

  <section class="bcls-section">
    <h2 id="Handling_page_events">Handling page events</h2>
    <p>When using web customization with your Beacon web apps, you can listen for page events and process custom code based on your requirements.</p>
    <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Page events" src="/assets/images/ott-plugins/page-events/page-event-diagram.svg" />
      <figcaption class="bcls-caption--image">Page events</figcaption>
    </figure>
    <!-- <div style="position: relative; display: block; max-width: 960px;">
      <div style="padding-top: 56.25%;"><iframe src="https://players.brightcove.net/1507807800001/default_default/index.html?videoId=6293553909001" allowfullscreen="" allow="encrypted-media" style="position: absolute; top: 0px; right: 0px; bottom: 0px; left: 0px; width: 100%; height: 100%;"></iframe></div>
    </div> -->
    <h3>Use cases</h3>  
    <p>Here are some use cases when listening to page events:</p>
    <ul>
      <li>A <strong>Download</strong> button to allow users to download a copy of the video</li>
      <li>A <strong>Location</strong> button to allow users to tag their location on videos</li>
    </ul>
  </section>

  <section class="bcls-section">
    <h2 id="Event_listeners">Event listeners</h2>
    <p>The following page events can be listened for by your Beacon plugin code:</p>
    <table class="bcls-table">
      <thead class="bcls-table__head">
        <tr>
          <th>Event</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td><code translate="No">beforeBeaconPageLoad</code></td>
          <td>Called before the page starts to load all of the required elements. This includes the API calls to fetch asset and playlist details</td>
        </tr>
        <tr>
          <td><code translate="No">onBeaconPageLoad</code></td>
          <td>Called when all of the required elements to render the page are available and all checks are complete (entitlements, episodes list, etc)</td>
        </tr>
        <tr>
          <td><code translate="No">onBeaconPageChange</code></td>
          <td>Called when there are changes in the Beacon web app page, and the component stays the same. Applicable to cases when the main asset changes and an episode is selected in the details page. For the Live TV page, it is also called when the selected linear channel changes.</td>
        </tr>
        <tr>
          <td><code translate="No">loadedBeaconVideoMetadata</code></td>
          <td>Called when the metadata for the current video has been loaded</td>
        </tr>
        <tr>
          <td><code translate="No">onBeaconPageUnload</code></td>
          <td>Called after the <code translate="No">destroy()</code> from the superclass finishes</td>
        </tr>
      </tbody>
    </table>
    <!-- <aside class="bcls-aside bcls-aside--information">When a user has a details page for a series open, and a new season/episode is selected, the previously added button will not be removed. </aside> -->
  </section>

  <section class="bcls-section">
    <h2 id="Event_data">Event data</h2>
    <p>When listening to page events, you can display the event data which is available for use in your custom code. Here are some examples of this data:</p>
    <h3><code translate="No">beforeBeaconPageLoad</code></h3>
    <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Before Beacon page load" src="/assets/images/ott-plugins/page-events/before-beacon-page-load.png" />
      <figcaption class="bcls-caption--image">Before Beacon page load</figcaption>
    </figure>

    <h3><code translate="No">onBeaconPageLoad</code></h3>
    <figure class="bcls-figure"><img class="bcls-image--no-border" alt="On Beacon page load" src="/assets/images/ott-plugins/page-events/beacon-page-load.png" />
      <figcaption class="bcls-caption--image">On Beacon page load</figcaption>
    </figure>

    <h3><code translate="No">loadedBeaconVideoMetadata</code></h3>
    <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Loaded Beacon page load" src="/assets/images/ott-plugins/page-events/beacon-video-metadata.png" />
      <figcaption class="bcls-caption--image">Loaded Beacon page load</figcaption>
    </figure>

    <h3><code translate="No">onBeaconPageUnload</code></h3>
    <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Beacon page unloaded" src="/assets/images/ott-plugins/page-events/beacon-page-unload.png" />
      <figcaption class="bcls-caption--image">Beacon page unloaded</figcaption> 
    </figure>
    
  </section>


  <section class="bcls-section">
    <h2 id="Code_syntax">Code syntax</h2>
    <p>Here is the JavaScript code syntax used for creating a custom button:</p>
    <pre class="line-numbers"><code class="language-javascript" translate="No">window.postMessage({
  event: 'detailsPageAddCustomButton',
  data: {
    title: 'Test Button',
    font_awesome_icon: 'fa fa-info-circle',
    element_id: 'TEST_BTN_ID'
  }
}, window.location.origin);</code></pre>
    <p>The following data can be passed with the button event:</p>
    <table class="bcls-table">
      <thead class="bcls-table__head">
        <tr>
          <th>Data element</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td><code translate="No">title</code></td>
          <td>string</td>
          <td>The name displayed in the button</td>
        </tr>
        <tr>
          <td><code translate="No">font_awesome_icon</code></td>
          <td>string</td>
          <td>The Font Awesome ID for the icon; leave empty if no icon is to be applied</td>
        </tr>
        <tr>
          <td><code translate="No">element_id</code></td>
          <td>string</td>
          <td>The HTML ID to be applied to this button</td>
        </tr>
      </tbody>
    </table>
   
    <p>Data notes:</p>
    <ul>
      <li>When calling <code translate="No">detailsPageRemoveCustomButton</code>, the only required field is the <code translate="No">element_id</code>.</li>
    </ul>
  </section>

  <section class="bcls-section">
    <h2 id="Module_implementation">Module implementation</h2>
    <p>The following shows how functions using the side panel are implemented using JavaScript modules. Of course, you may implement your JavaScript in the manner of your choice. Further details on this module implementation can be found in the <a href="">Implementing Beacon Plugin Code Using Modules</a> document.</p>
    
    <h3><code translate="No">index.js</code></h3>
    <p>Here is our example code:</p>
    <pre class="line-numbers"><code class="language-javascript" translate="No">import { addCustomButtonDetails, addCustomButtonDetailsParams, handleButtonClick } from './button-module.js';

window.addEventListener(&quot;message&quot;, (event) =&gt; {
  const originsAllowed = [
    '<span class="bcls-input">your Beacon app URL</span>'
  ];
  if (originsAllowed.includes(event.origin)) {
    switch (event.data.event) {
      
      case 'detailsPageExternalButtonWasClicked':
        if (event.data.data.element_id == 'download-button') {
          handleButtonClick('Download button'); 
        };
        if (event.data.data.element_id == 'location-button') {
          handleButtonClick('Location button');
        };
        break;
        
      case 'onBeaconPageLoad':
        addCustomButtonDetailsParams('Download', 'fa fa-info-circle', 'download-button');
        addCustomButtonDetailsParams('Location', 'fa fa-info-circle', 'location-button');
      break;

    }
  }
},
  false
);</code></pre>

    <table class="bcls-table">
      <thead class="bcls-table__head">
        <tr>
          <th>Event</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td><code translate="No">detailsPageExternalButtonWasClicked</code></td> 
          <td>Listen for this event. When triggered, do the following:
            <ul>
              <li>Check the code translate="No">event.data.data.element_id</code> to determine which button was clicked</li>
              <li>Call the <strong>handleButtonClick</strong> function with the button value.</li>
            </ul> 
          </td>
        </tr>
        <tr>
          <td><code translate="No">onBeaconPageLoad</code></td>
          <td>Listen for this event. When triggered, do the following:
            <ul>
              <li>Call the <strong>addCustomButtonDetailsParams</strong> function to add the Download button.</li>
              <li>Call the <strong>addCustomButtonDetailsParams</strong> function to add the Location button.</li>
            </ul> 
          </td>
        </tr>
       
      </tbody>
    </table>

    <h3><code translate="No">button-module.js</code></h3>
    <p>Here is our example code:</p>
    <pre class="line-numbers"><code class="language-javascript" translate="No">const addCustomButtonDetails = () =&gt; {
  
      window.postMessage({
        event: 'detailsPageAddCustomButton',
        data: {
          title: 'Test Button',
          font_awesome_icon: 'fa fa-info-circle',
          element_id: 'TEST_BTN_ID'
        }
      }, window.location.origin);
    
    };
    
    const addCustomButtonDetailsParams = (pTitle, pFont, pID) =&gt; {
      
      window.postMessage({
        event: 'detailsPageAddCustomButton',
        data: {
          title: pTitle,
          font_awesome_icon: pFont,
          element_id: pID
        }
      }, window.location.origin);
    
    };
    
    const handleButtonClick = (buttonString) =&gt; {
    
      alert('button was clicked ' + buttonString);
    
    };
    
    export { addCustomButtonDetails, addCustomButtonDetailsParams, handleButtonClick };</code></pre>

    <table class="bcls-table">
      <thead class="bcls-table__head">
        <tr>
          <th>Function</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td><code translate="No">addCustomButtonDetails</code></td>
          <td>Dispatches the <code translate="No">detailsPageAddCustomButton</code> event to create a custom button on the details page, at the end of the buttons list.<br/>
             The <code translate="No">title</code>, <code translate="No">font_awesome_icon</code> and <code translate="No">element_id</code> values are passed into this function as strings, using the <code translate="No">data</code> object.</td>
        </tr>
        <tr>
          <td><code translate="No">addCustomButtonDetailsParams</code></td>
          <td>Dispatches the <code translate="No">detailsPageAddCustomButton</code> event to create a custom button on the details page, at the end of the buttons list.<br/>
             This function uses the <code translate="No">pTitle</code>, <code translate="No">pFont</code> and <code translate="No">pID</code> parameters to populate the <code translate="No">title</code>, <code translate="No">font_awesome_icon</code> and <code translate="No">element_id</code> values in the <code translate="No">data</code> object.</td>
        </tr>
        <tr>
          <td><code translate="No">handleButtonClick</code></td>
          <td>Displays an alert box with a message identifying the button that was clicked.</td>
        </tr>
      </tbody>
    </table>
  </section>


</article>